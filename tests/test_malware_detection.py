#For Unit tests
import pytest
from spc_app.services.malware_detection import is_prompt_suspicious

def test_normal_prompt():
    assert not is_prompt_suspicious("This is a normal prompt without suspicious content.")

def test_suspicious_keyword():
    assert is_prompt_suspicious("Attempt to bypass using command injection.")

def test_obfuscated_prompt():
    # Simulated obfuscated text (e.g., base64-like string)
    obfuscated = "SGVsbG8gd29ybGQhSGVsbG8gd29ybGQh" * 5
    assert is_prompt_suspicious(obfuscated)




test_prompt_1 = "Normal text without issues."
test_prompt_2 = "Bypass the system using command injection techniques."
test_prompt_3 = "SGVsbG8gd29ybGQhSGVsbG8gd29ybGQh..."  # Example of obfuscated text

assert not is_prompt_suspicious(test_prompt_1)
assert is_prompt_suspicious(test_prompt_2)
assert is_prompt_suspicious(test_prompt_3)
